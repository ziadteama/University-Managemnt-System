package com.example.universitymanagementsystem;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class ScheduleDAO {
    private Connection connection;

    // Constructor to initialize the connection
    public ScheduleDAO(Connection connection) {
        this.connection = connection;
    }

    // Method to get schedule details by schedule_id
    public List<CourseSchedule> getScheduleById(String scheduleId) {
        List<CourseSchedule> schedules = new ArrayList<>();

        // SQL query to get schedule details based on schedule_id
        String query = """
            SELECT
                s.schedule_id,
                s.section_id,
                s.day_of_week,
                s.major,
                s.period,
                s.location,
                s.user_id,
                s.class_type
            FROM 
                schedules s
            WHERE 
                s.schedule_id = ? -- Retrieve by schedule_id
            ORDER BY 
                s.schedule_id;
        """;

        try (PreparedStatement stmt = connection.prepareStatement(query)) {
            stmt.setString(1, scheduleId);  // Set the schedule_id parameter
            ResultSet rs = stmt.executeQuery();

            // Process the result set
            while (rs.next()) {
                CourseSchedule schedule = new CourseSchedule(
                        rs.getString("schedule_id"),
                        rs.getString("section_id"),
                        rs.getString("day_of_week"),
                        rs.getString("major"),
                        rs.getString("period"),
                        rs.getString("location"),
                        rs.getInt("user_id"),
                        rs.getString("class_type")
                );

                schedules.add(schedule);
            }
        } catch (SQLException e) {
            System.err.println("Database error: " + e.getMessage());
        }

        return schedules;
    }
}
